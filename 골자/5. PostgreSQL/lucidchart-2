(피피티)
이제 본격적으로 관계형데이터베이스의 관계에 대해 알아볼거에요
핵심은 두 관계 사이의 미니멈과 맥시멈을 아는 것입니다.
이알디에 대한 여러가지 이론이 있어요
많이 쓰이는게 유엠엘 방식이 있고
까마귀 발 표기법이라고
우리가 지금 하고있는 크로우즈 풋 방식인데
우린 크로우즈 풋 방식으로 진행하겠습니다.

(다음)
위에서부터
하나, 다수, 반드시 하나, 영또는 하나, 하나 또는 다수, 0또는 다수입니다.
우리의 테이블간의 관계를 따져서 이 중에 하나를, 방향에 맞춰서 쓸거에요
원과 원앤온리원의 차이는 뭘까요

(다음)
원은 하나인건 맞는데 다른걸로 대체할 수 없는것을 의미합니다.
먼저 원
기숙사 방을 생각해보면, 한 명은 들어가있어야되지만 내년에 그 방에 들어가는놈은
다를 수 있죠
원 앤 온리 원은
한번 매칭되면 절대 다른것으로 대체되지 않는것을 의미합니다.
학번이 있을수있겠죠
내가 졸업하더라도 나의 학번은 타인에게 절대 넘어가지 않죠
이 경우엔 원앤온리원입니다.
이렇게 무작정 말하면 어렵고, 우리 예제에서 살펴보도록 하죠

(다음)
두 개의 테이블엔 총 네개의 질문이 필요합니다.
세개의 테이블엔 총 열두개의 질문이 필요해요
왜? 두개의 테이블간에 총 네개의 질문이 필요하니깐
일단 두개의 테이블만 살펴봅시다
텍스트와 코멘트간의 관계를 생각해보죠
텍스트가 가질 수 있는 최대한의 코맨트는 몇개입니까?
매니이죠. 왜? 하나의 글엔 여러개의 댓글이 달릴 수 있잖아요
텍스트가 가질 수 있는 최소한의 코멘트는 몇개에요?
제로죠. 왜? 댓글이 하나도 없을 수 있잖아요
그래서 그림과같이, 동그라미에 세 개를 결합해서 쓰는거에요
제로 올 매니
그럼 반대로 생각해보죠
코멘트가 가질 수 있는 최대한의 텍스트는 몇개에요?
딱 하나죠. 하나의 댓글은 딱 그 글에만 달리는거잖아요
코멘트가 가질 수 있는 최소한의 텍스트는 몇개에요?
그것도 딱 하나죠. 댓글이 일단 만들어졌으면 딱 하나의 글에만 달리잖아요
그래서 원 앤온리 원입니다.
이렇게 두 줄로 그어서 표현해요

이런식으로 그려봅시다


///////

여기서, 조금 비논리적이긴 한데 나중에 나올 브릿지테이블을 설명하기 위해서
하나의 글엔 여러명의 글쓴이가 있을 수 있다고 가정해보겠습니다.
그러면 텍스트가 가질 수 있는 최대한의 유저는 몇명일까?
하나의 글에 조교행님, 수지니가 동시에 수정할수 있다고 생각해볼게요
그러면 이 경우엔 매니겠죠?
하나의 텍스트가 가질 수 있는 최소한의 유저는 몇개입니까?
하나죠. 글이 일단 쓰여졌다면 누가 쓰긴 썼을거아니에요
반대로, 유저가 가질 수 있는 최대한의 텍스트는 몇개일까요?
한 회원이 여러개 글을 쓸 수 있겠죠?
그래서 매니입니다.
유저가 가질 수 있는 최소한의 텍스트는 몇 개일까요?
제로죠. 어떤 회원이 글을 아예 안 쓸수도 있으니까요
이제 유저와 코멘트의 관계를 생각해보죠
하나의 유저가 가질 수 있는 최대한의 코멘트는?
매니죠. 한 회원이 여러개 댓글을 쓸 수 있잖아요
하나의 유저가 가질 수 있는 최소한의 코멘트는?
제로죠. 활동하면서 댓글을 아예 안 쓸수도 있잖아요
반대로
하나의 코멘트가 가질 수 있는 최대한의 유저는?
딱 하나죠. 일단 댓글이 생기면 한명이 쓴거니깐
그럼 하나의 코멘트가 가질 수 있는 최소한의 유저는?
그것도 딱 하나죠. 댓글이 생기면 한명이 쓴거니깐
그래서 원 앤 온리원입니다.

그렇게해서 다음과 같이 그려봤어요
텍스트와 유저의 관계가 비상식적이긴한데, 
브릿지 테이블을 설명하기위해 조금 비논리적으로 작성했습니다.

(피피티)
이제 관계를 짓기 위해서 외래키, 영어로는 포린키, 짧게는 에프케이를 집어넣을건데,
저번에 설명했듯이 에프케이는 다른 테이블에 있는 피케이입니다.
한쪽 테이블엔 피케이가, 연결된 다른 테이블엔 에프케이가 있는거에요
에프케이의 특징은,
피케이는 중복이 안되는데
에프케이는 중복 가능합니다.
왜? 한 사람이 같은글에 댓글을 여러개 쓸 수 있으니깐.
그리고 여러개의 에프케이가 한 테이블에 존재 가능합니다.
예를들면 코멘트는 텍스트 및 유저 정보를 둘 다 필요로 하죠
그래서 코멘트는 피케이인 코멘트아이디, 에프케이인 텍스트아이디, 유저아이디 총 3개의 키를 가질겁니다.
한쪽엔 피케이, 다른쪽엔 에프케이가 있어야하는데
어느쪽에 에프케이를 둘 것인가는 상황에 따라 판단해야합니다.

(다음)
총 세 개의 상황으로 나뉩니다.
원투매니
원투원
매니투매니

(다음)
첫번째 원투매니
가장 쉬워요. 원쪽이 피케이, 매니쪽이 에프케이입니다.
텍스트와 코멘트 관계를 보면 텍스트가 원이죠?
여기에 피케이를 두고
코멘트엔 텍스트의 피케이인 텍스트아이디를 에프케이로 둡니다.

(다음)
다음은 원투원
여기선 자유롭게 추가할 수 있는 테이블이 피케이입니다.
지금 이알디에선 해당 관계를 확인할 수 없기 때문에 하나를 새로 만들어볼게요
교육의 목적을 위해서

(실습)
우리가 유저엔 이즈액티비티 애트리뷰트를 넣어놨는데
삭제를 하고 테이블로 따로 뺄게요
인액티비티로 하고
상식적으로 에프케이가 어디있으면 되겠어요?
인액티비티에 있으면 되겠죠
왜? 유저가 있어야 휴면계정여부도 따질수 있으니까요
인액티비티는 함부로 추가할 수 없는거에요
그러니깐 자유롭게 추가할 수 있는 테이블이 피케이가 되는겁니다.
그러면 인액티비티는 굳이 피케이가 필요하진 않겠네요
관계를 가져오면 되니깐
그럼 관계 따져봅시다
한명의 유저가 가질 수 있는 최대한의 인액티비티는?
하나죠
한명의 유저가 가질 수 있는 최소한의 인액티비티는?
제로죠. 휴면이 아닐수도 있으니깐
그러니깐 동그라미하고 직선
그럼 반대로
인액티비티가 가질 수 있는 최대한의 오써는?
하나죠? 딱 그 계정만 가질거니깐
최소한은?
하나죠. 일단 부여가 되면 하나는 가져야되니깐
그래서 원 작대기 두개

(피피티)
정리해보면, 자유롭게 추가할 수 있는 테이블이 피케이라는겁니다.

(다음)
제일 중요한게 매니투매니
이 경우엔 브릿지 테이블이 필요해요.
브릿지 무슨뜻입니까? 다리라는 뜻이에요
매핑 테이블이라고도 합니다.
테이블과 테이블을 이어주는 테이블입니다.
테이블을 하나 더 추가해볼게요
write 라는 테이블을 만들고
에프케이를 두개 둘겁니다
하나는 텍스트아이디
하나는 유저아이디
그리고 기준은 시간으로 하죠. 크리에이티드라고 적고
타입은 타임스태프존
이것은 각각의 유저가 언제 글을 썼는지 나타내주는 정보입니다.
만약 1번 저자가 3번글도 쓰고 5번글도 쓴 경우에
둘을 나누는 기준은 작성시간일겁니다.
브릿지로 나눠놨으니깐 여기선 그냥 선만 그어놓을게요

그럼 다음과 같습니다.
